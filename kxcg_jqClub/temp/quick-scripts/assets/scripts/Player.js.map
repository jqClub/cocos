{"version":3,"sources":["Player.js"],"names":["log","console","bind","cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","accLeft","accRight","xSpeed","jumpAudio","default","type","AudioClip","playJumpSound","audioEngine","playEffect","setJumpAction","that","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","repeatForever","sequence","onLoad","jumpAction","node","runAction","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","event","keyCode","macroKey","macro","KEY","a","d","start","update","dt","Math","abs","symbol","x","onDestroy","off","hidePlayer","active"],"mappings":"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","file":"Player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar log = console.log.bind(console)\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    // 规定一个节点具有的全部属性，都需要写在properties里面\r\n    properties: {\r\n        // 主角跳跃高度\r\n        jumpHeight: 0,\r\n        // 主角跳跃持续时间\r\n        jumpDuration: 0,\r\n        // 最大移动速度\r\n        maxMoveSpeed: 0,\r\n        // 加速度\r\n        accel: 0,\r\n// -------------------------\r\n        // 1.7新增配置参数\r\n        // 加速方向的开关\r\n        accLeft: false,\r\n        accRight: false,\r\n        // 水平方向的加速度\r\n        xSpeed: 0, \r\n\r\n\r\n        // 跳跃音效资源\r\n        jumpAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n    },\r\n    // 播放音效\r\n    playJumpSound: function () {\r\n        // 调用声音引擎播放声音\r\n        cc.audioEngine.playEffect(this.jumpAudio, false);\r\n    },\r\n    setJumpAction: function() {\r\n        var that = this\r\n         // 跳跃上升\r\n         var jumpUp = cc.moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n         // 下落\r\n         var jumpDown = cc.moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        //  增加一个音效的回调函数\r\n        var callback = cc.callFunc(this.playJumpSound, that)\r\n\r\n         // 不断重复\r\n         return cc.repeatForever(cc.sequence(jumpUp, jumpDown, callback));\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        var that = this\r\n         // 初始化跳跃动作\r\n         this.jumpAction = this.setJumpAction();\r\n         this.node.runAction(this.jumpAction);\r\n        // // 创建一个移动动作\r\n        // var actionTo = cc.scaleTo(2, 0.5);\r\n        // // 执行动作\r\n        // this.node.runAction(actionTo);\r\n        \r\n        // 让节点左右来回移动\r\n        // var seq = cc.sequence(cc.moveBy(0.5, 200, 0), cc.moveBy(0.5, -200, 0));\r\n        // 让节点上下来回移动\r\n        // var seq = cc.sequence(cc.moveBy(0.5, 200, 200), cc.moveBy(0.5, -200, -200));\r\n        // var lastSeq = cc.repeatForever(seq);\r\n\r\n        // // 不停旋转的封面图片\r\n        // var lastSeq = cc.repeatForever(cc.rotateBy(1.0, 360));\r\n        // that.node.runAction(lastSeq);\r\n\r\n        // 初始化键盘输入监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this); \r\n        \r\n        \r\n        // 使用枚举类型来注册，点击的事件\r\n        // that.node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n        //     console.log('Mouse down');\r\n        // }, this);\r\n\r\n        // 使用事件名来注册，点击的事件\r\n        // that.node.on('touchstart', function (event) {\r\n        //     console.log(event)\r\n        //     console.log('Mouse down', event.getLocation());\r\n        // }, this);\r\n    },\r\n    // 监听移动控制的事件\r\n    onKeyDown: function(event) {\r\n        // 键盘按下\r\n        var that = this\r\n        var keyCode = event.keyCode\r\n        var macroKey = cc.macro.KEY\r\n        if(keyCode == macroKey.a) {\r\n            this.accLeft = true\r\n        } else if(keyCode == macroKey.d) {\r\n            this.accRight = true\r\n        }\r\n        // log(11111, that.accLeft, this.accRight)\r\n    },\r\n    onKeyUp: function(event) {\r\n         // 键盘松开\r\n        var that = this\r\n        var keyCode = event.keyCode\r\n        var macroKey = cc.macro.KEY\r\n        if(keyCode == macroKey.a) {\r\n            this.accLeft = false\r\n        } else if(keyCode == macroKey.d) {\r\n            this.accRight = false\r\n        }\r\n        // log(11111, that.accLeft, this.accRight)\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n    // 更新节点的坐标和速度，update在场景加载后，就会每帧调用一次，\r\n    // 一般把经常需要计算或更新的放在这里\r\n    update (dt) {\r\n        var that = this\r\n        if(that.accLeft) {\r\n            that.xSpeed -= that.accel * dt\r\n        } else if(that.accRight) {\r\n            that.xSpeed += that.accel * dt\r\n        }\r\n        if(Math.abs(that.xSpeed) > that.maxMoveSpeed) {\r\n            // 乘以对应的符号，Math.abs是取绝对值\r\n            var symbol = that.xSpeed / Math.abs(that.xSpeed)\r\n            that.xSpeed = that.maxMoveSpeed * symbol\r\n        }\r\n\r\n\r\n        // var width = that.game.background.width\r\n        // if(Math.abs(that.xSpeed) > width) {\r\n        //             //     // 乘以对应的符号，Math.abs是取绝对值\r\n        //     var symbol = that.xSpeed / Math.abs(that.xSpeed)\r\n        //     that.xSpeed = width * symbol\r\n        // }\r\n        this.node.x = that.xSpeed\r\n    },\r\n\r\n    // 在销毁的时候，不去监听键盘的事件\r\n    onDestroy() {\r\n        // 取消键盘输入监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n\r\n    hidePlayer: function() {\r\n        var that = this\r\n        var active = that.node.active\r\n        that.node.active = !active\r\n    },\r\n});\r\n"]}